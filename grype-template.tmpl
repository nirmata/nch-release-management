{{- /* Custom Grype template to extract vulnerability data with published dates */ -}}
NAME,INSTALLED,FIXED_IN,TYPE,VULNERABILITY,SEVERITY,EPSS,RISK,PUBLISHED_DATE
{{- range .Matches -}}
"{{.Artifact.Name}}",
"{{.Artifact.Version}}",
"{{- if .Vulnerability.Fix.Versions -}}{{index .Vulnerability.Fix.Versions 0}}{{- else -}}{{- end -}}",
"{{.Artifact.Type}}",
"{{.Vulnerability.ID}}",
"{{.Vulnerability.Severity}}",
"{{- if .Vulnerability.EPSS -}}{{- if gt (len .Vulnerability.EPSS) 0 -}}{{printf "%.3f" (mul (index .Vulnerability.EPSS 0).Percentile 100)}}%{{- else -}}N/A{{- end -}}{{- else -}}N/A{{- end -}}",
"{{- if .Vulnerability.Risk -}}{{printf "%.6f" .Vulnerability.Risk}}{{- else -}}N/A{{- end -}}",
"{{- if .Vulnerability.PublishedDate -}}{{.Vulnerability.PublishedDate}}{{- else -}}N/A{{- end -}}"
{{- end -}}
